
 
  <div class="container">



<label for="diffSelect">Please select a difficulty: </label>

<select name="diffSelect" id="diffSelect">
  <option value="all">all</option>
  <option value="easy">easy</option>
  <option value="easy/intermediate">easy/intermediate</option>
  <option value="intermediate">intermediate</option>
  <option value="intermediate/difficult">intermediate/difficult</option>
  <option value="hard">hard</option>
  <option value="very hard">very hard</option>
</select> 

<label for="location">Please enter a location: </label>
<input type="text" id="location" name="location" required
       minlength="4" maxlength="20" size="20" value = ""><br>
        <!--
       <input type = "button" id = "driver" value = "Get Trails nearby" class="btn btn-primary">
       
       <input type="checkbox" id="filter" name="filter" value="filterMe">
        <label for="filter"> Limit results based off fitness level</label>
        -->
       <input type = "button" id = "driver2" value = "Display Results" class="btn btn-primary">



 <div id = "stage" class = "container">
    RESULTS
 </div>
 <table id="table"> 
   <!-- # name length location -->
   
</table> 
<script type = "text/javascript" language = "javascript">
function getDirections(scriptLat, scriptLng){
  
  sessionStorage.setItem('trailLat', scriptLat);
  sessionStorage.setItem('trailLng', scriptLng);

  location.href = "/directions";
}

</script>

<script type = "text/javascript" language = "javascript">
function getGear(scriptLat, scriptLng, scriptDiff){
  
  sessionStorage.setItem('trailLat', scriptLat);
  //console.log(sessionStorage.getItem('trailLat'));
  sessionStorage.setItem('trailLng', scriptLng);
  //console.log(sessionStorage.getItem('trailLng'));
  sessionStorage.setItem('trailDiff', scriptDiff);
  //console.log(sessionStorage.getItem('trailDiff'));
  location.href = "/recommendation";
}

</script>


   <script type = "text/javascript" language = "javascript">

    $(document).ready(function() {

      
      var lat = 40.0274;
      var lng = -105.2519;

      var latNew;
      var lngNew;
  
 
       $("#driver2").click(function(event){
         var myLoc = document.getElementById("location").value;
         var myDiff = document.getElementById("diffSelect").value;

         myNewLoc = (myLoc.replace(/ /g, '%2C%'));
         myNextNewLoc = (myNewLoc.replace(/[',']+/g, ''));
         //console.log(sessionStorage.getItem('fitlevel'));
         //console.log(myNextNewLoc);

        $.get( "https://api.opencagedata.com/geocode/v1/google-v3-json?q="+myNextNewLoc+"&key={{oc_api}}&pretty=1&no_annotations=1", function(kd) {


            latNew = JSON.stringify(kd.results[0].geometry.location.lat);
            lngNew = JSON.stringify(kd.results[0].geometry.location.lng);



            
            lat = (latNew.replace(/['"]+/g, ''));
            lng = (lngNew.replace(/['"]+/g, ''));



         var x = "<tr><td>"+ "#" +"</td><td>" + "Name" + "</td><td>"+"Length" +"</td><td>"+ "Difficulty" +"</td><td>"+ "Location" + "</td></tr>";
         document.getElementById("table").innerHTML = "";
         
          

            //console.log(latNew);
            //console.log(lngNew);
       

          $.getJSON('https://www.hikingproject.com/data/get-trails?lat='+lat+'&lon='+lng+'&maxDistance=10&key={{trail_api}}', function(jd) {
             
            var sum = 0;
             //console.log(JSON.stringify(jd));
             for (i in jd.trails) {
               //console.log(myDiff);

               var tDiff;
               if(jd.trails[i].difficulty == 'green'){
                  tDiff = 'easy';
               }
               else if(jd.trails[i].difficulty =='greenBlue'){
                 tDiff = 'easy/intermediate';
               }
              else if(jd.trails[i].difficulty == 'blue'){
                tDiff = 'intermediate';
               }
               else if(jd.trails[i].difficulty == 'blueBlack'){
                 tDiff = 'intermediate/difficult';
               }
               else if(jd.trails[i].difficulty == 'black'){
                 tDiff = 'hard';
               }
               else{
                 tDiff = 'very hard';
               }
            
               //console.log(jd.trails[i].difficulty);
               //console.log(tDiff);
               if(tDiff == myDiff || myDiff == 'all'){
                 //console.log('match');
               
               var tempLat;
               var tempLng;

               tempLat = jd.trails[i].latitude;
               tempLng = jd.trails[i].longitude;
               tempDiff = jd.trails[i].difficulty

               var myLocString = tempLat+", "+tempLng;

               var myLocDiffString = myLocString+", "+ "\""+tDiff+"\"";

              //console.log(myLocDiffString);

               sum++;
                x += "<tr><td>"+ sum +"</td><td>" + jd.trails[i].name + "</td><td>"+jd.trails[i].length +"</td><td>"+tDiff +"</td><td>"+jd.trails[i].location +"</td><td>" +  "<button onclick='getDirections("+myLocString+")'>Get Directions</button>"+"</td><td>"+"</td><td>" +  "<button onclick='getGear("+myLocDiffString+")'>Get Gear Recommendations</button>"+"</td></tr>";
             }
             }
              document.getElementById("table").innerHTML = x;

          });
       });
    });


    });
 </script>


 </div>

 